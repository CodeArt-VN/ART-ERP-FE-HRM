<ion-header>
	<app-toolbar [page]="this"></app-toolbar>
</ion-header>

<ion-content appScrollbarTheme class="ion-padding">
	<div class="main-view safe-max-width" *ngIf="item && pageConfig.showSpinner==false">
		<ion-grid fixed>
			<form [formGroup]="formGroup">
				<ion-row>
					<ion-col size="12" class="ion-padding-vertical">
						<app-page-title [icon]="pageConfig.pageIcon" [title]="formGroup.get('Name').value" [remark]="formGroup.get('Remark').value"> </app-page-title>
					</ion-col>
				</ion-row>
			</form>
		</ion-grid>

		<ion-segment scrollable="true" (ionChange)="segmentChanged($event)" [value]="segmentView">
			<ion-segment-button value="s1">
				<ion-label>{{'General' | translate }}</ion-label>
			</ion-segment-button>

			<ion-segment-button value="s2">
				<ion-label>{{'Form & mapping' | translate }}</ion-label>
			</ion-segment-button>
		</ion-segment>

		<div class="ion-padding" *ngIf="segmentView == 's1'">
			<ion-grid fixed>
				<form [formGroup]="formGroup">
					<ion-row class="hr-group">
						<ion-col size="12" size-sm="12" size-md="12" size-xl="3">
							<ion-list-header class="ion-no-padding">
								<ion-label color="primary">{{'Welfare policy' | translate}}</ion-label>
							</ion-list-header>
						</ion-col>
						<ion-col size="12" size-sm size-xl="4">
							<app-form-control (change)="saveChange()" [field]="{id: 'Code', label: 'Code', type: 'text', form: formGroup}"> </app-form-control>
							<app-form-control (change)="saveChange()" [field]="{id: 'Name', label: 'Name', type: 'text', form: formGroup}"> </app-form-control>
						
						</ion-col>
						<ion-col size="12" size-sm size-xl="4">
							<app-form-control
								(change)="saveChange()"
								[field]="{id: 'Type', label: 'Type', type: 'ng-select-status', dataSource: typeList, bindLabel: 'Name', bindValue: 'Code', form: formGroup}"
							>
							</app-form-control>
						</ion-col>
					</ion-row>

					<ion-row class="hr-group">
						<ion-col size="12" size-sm="12" size-md="12" size-xl="3">
							<ion-list-header class="ion-no-padding">
								<ion-label color="primary">{{'Other information' | translate}}</ion-label>
							</ion-list-header>
						</ion-col>
						<ion-col size="12" size-sm size-xl="4">
							<app-form-control [field]="{id: 'CreatedBy', type: 'text', label: 'Created by', form: formGroup }"></app-form-control>
							<app-form-control [field]="{id: 'CreatedDate', type: 'span-datetime', label: 'Created date', form: formGroup }"></app-form-control>
							<app-form-control [field]="{id: 'ModifiedBy', type: 'text', label: 'Last modified by', form: formGroup }"></app-form-control>
							<app-form-control [field]="{id: 'ModifiedDate', type: 'span-datetime', label: 'Last modified date', form: formGroup }"></app-form-control>
						</ion-col>
						<ion-col size="12" size-sm size-xl="4">
							<app-form-control (change)="saveChange()" [field]="{id: 'Remark', label: 'Remark', type: 'textarea', form: formGroup}"> </app-form-control>
						</ion-col>
					</ion-row></form
			></ion-grid>
		</div>

		<div class="ion-padding" *ngIf="segmentView == 's2'">
			<app-data-table
				class="box-shadow responsive"
				[rows]="UDFItems"
				[trackBy]="'Id'"
				[showSpinner]="pageConfig.showSpinner"
				[showFilter]="pageConfig.isShowSearch"
				[(query)]="query"
				(dataInfinite)="loadData($event)"
				(filter)="onDatatableFilter($event)"
				(sort)="onSort($event)"
			>
				<datatable-column [checkbox]="true" name="" property="_checked">
					<ng-template let-i="row" datatable-cell-template>
						<ion-checkbox [checked]="i?._checked" (ionChange)="selectRow(i)"></ion-checkbox>
					</ng-template>
				</datatable-column>
				<datatable-column class="col-name" name="Name" property="Name"></datatable-column>
				<datatable-column class="col-code" name="Is income" property="_isIncome"> 
					<ng-template let-i="row" datatable-cell-template>
						<ion-icon *ngIf="!i?.isEdit && i?._checked" class="min-btn" [name]="i._isIncome?'checkmark-outline': 'ban-outline'" [color]="i._isIncome?'primary':'red'"></ion-icon>
						<app-input-control *ngIf="i?.isEdit" [field]="{id:'IsIncome', type: 'checkbox', form : i?._formGroup }"></app-input-control>
					</ng-template> </datatable-column>
				<datatable-column class="col-code" name="Is currency" property="_isCurrency">
					<ng-template let-i="row" datatable-cell-template>
						<ion-icon *ngIf="!i?.isEdit && i?._checked" class="min-btn" [name]="i._isCurrency?'checkmark-outline': 'ban-outline' "></ion-icon>
						<app-input-control *ngIf="i?.isEdit" [field]="{id:'IsCurrency', type: 'checkbox', form : i?._formGroup }" ></app-input-control>
					</ng-template>
				</datatable-column>
				<datatable-column class="col-code" name="Is manager can create benefit" property="_isManagerCanCreateBenefit">
					<ng-template let-i="row" datatable-cell-template>
						<ion-icon *ngIf="!i?.isEdit && i?._checked" class="min-btn" [name]="i._isManagerCanCreateBenefit?'checkmark-outline': 'ban-outline' " [color]="i._isManagerCanCreateBenefit?'red':''"></ion-icon>
						<app-input-control *ngIf="i?.isEdit" [field]="{id:'IsManagerCanCreateBenefit', type: 'checkbox', form : i?._formGroup }" ></app-input-control>
					</ng-template>
				</datatable-column>
				<datatable-column class="col-name" name="Frequency" property="_frequency">
					<ng-template let-i="row" datatable-cell-template>
						<span *ngIf="!i?.isEdit">{{i?._frequency | translate}}</span>
						<app-input-control *ngIf="i?.isEdit" [field]="{id:'Frequency', type: 'ng-select', dataSource:frequencyList, bindValue:'Code',bindLabel:'Name' ,form : i?._formGroup }" ></app-input-control>
					</ng-template>

				</datatable-column>
				<datatable-column class="col-number" name="Value" property="Name">
					<ng-template let-i="row" datatable-cell-template>
						<span *ngIf="!i?.isEdit">{{i?._value | number:'1.0-0'}}</span>
						<app-input-control *ngIf="i?.isEdit" [field]="{id:'Value', type: i?.ControlType, form : i?._formGroup }"></app-input-control>
					</ng-template>
				</datatable-column>
				<datatable-column class="col-icon" name="" property="Id">
					<ng-template let-i="row" datatable-cell-template>
						<ion-button *ngIf="!i?.isEdit && i?._checked" (click)="editRow(i)" size="small" title="{{'Edit' | translate}}" fill="clear">
							<ion-icon slot="icon-only" name="pencil"></ion-icon>
						</ion-button>
						<div class="text-center">
							<ion-button *ngIf="i?.isEdit" (click)="saveRow(i)" size="small"> {{'Save' | translate}} </ion-button>
							<br />
							<ion-button *ngIf="i?.isEdit" (click)="cancelRow(i)" size="small" fill="outline"> {{'Cancel' | translate}} </ion-button>
						</div>
					</ng-template>
				</datatable-column>
			</app-data-table>
		</div>
	</div>

	<app-page-message [itemsLength]="item? 1: 0" [showSpinner]="pageConfig.showSpinner"></app-page-message>
</ion-content>
